# HU-002: API del Microservicio de OCR

**Como:** Desarrollador / Sistema Integrador  
**Quiero:** Un microservicio que requiera una API Key válida para procesar imágenes (POST) y permita verificar su estado (GET)  
**Para:** Controlar el acceso al servicio de OCR y monitorear su disponibilidad  

## Criterios de Aceptación

| Escenario | Dado que (Given) | Cuando (When) | Entonces (Then) |
|-----------|------------------|---------------|-----------------|
| **Acceso Autorizado (API Key)** | El servicio recibe una petición POST con una API Key en la cabecera | El middleware consulta la base de datos y confirma que la clave existe y es válida | El servicio permite el procesamiento de la imagen y retorna éxito `200` |
| **Acceso Denegado (API Key Inválida)** | El servicio recibe una petición POST con una API Key incorrecta o expirada | El middleware consulta la base de datos y la clave no es válida | El servicio rechaza la solicitud con un código HTTP `401` Unauthorized o `403` Forbidden |
| **Sin API Key** | El servicio recibe una petición POST sin la cabecera de autenticación | El middleware intercepta la solicitud antes de procesar | El servicio retorna un error HTTP `401` indicando que `la API Key es requerida` |
| **Validación de Imagen** | La petición tiene una API Key válida | El cuerpo de la solicitud no contiene una imagen válida | El servicio retorna un código HTTP 400 Bad Request |
| **Verificación de Estado (Health Check)** | El microservicio se encuentra en ejecución | Se realiza una petición GET al endpoint de `/health` | El servicio responde con HTTP `200` y estado "OK" (generalmente público para monitoreo) |
| **Error de Base de Datos** | El servicio intenta validar la API Key | La base de datos de claves no está disponible | El servicio retorna un error HTTP `500` indicando fallo interno en la validación |
